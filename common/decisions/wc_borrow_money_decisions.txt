borrow_from_goblins_decision = {
	picture = "gfx/interface/illustrations/decisions/goblo.dds"
	selection_tooltip = goblin_money_tooltip
	desc = goblin_money_decision_desc
	confirm_text = goblin_money_decision_confirm

	cost = {
		prestige = 100
	}

	is_shown = {
                      
		is_landed = yes
		highest_held_title_tier > tier_baro
		NOR = {
			exists = var:loan_amount_owed
			exists = var:loan_holder
		}
	}
	


	effect = {
		hidden_effect = {
			#NAME AND VALUE NEED#
			set_variable = {
				name = amount_to_loan
				value = holy_order_gold_value
				days = 1
			}
			#FLAG NEEDS TO BE CHANGED#
			add_character_flag = {
				flag = borrow_from_holy_order
				days = 3560
			}
			trigger_event = #CREATE CUSTOM EVENT##holy_order.0200
		}
		custom_tooltip = #CREATE CUSTOM TOOLTIP##borrow_from_holy_order_decision_effect_tooltip

	}
	
	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 50
		ai_value_modifier = {
			ai_zeal = -0.5
		}
		ai_value_modifier = {
			ai_greed = 0.5
		}
	}

}

#ALL FLAGS/VARIABLES/LOCALIZATION NEEDS TO BE REMADE#
repay_loan_decision = { 
	picture = "gfx/interface/illustrations/decisions/payback.dds"

	major = yes

	desc = repay_goblin_loan_desc
	selection_tooltip = repay_goblin__loan_tooltip

	ai_check_interval = 0

	is_shown = {
		trigger_if = {
			limit = {
				has_character_flag = borrow_from_holy_order
			}
			faith = {
				any_faith_holy_order = { #Your faith must have a Holy Order
					leader = {
						exists = var:owes_me_money
						var:owes_me_money = root
					}
				}
			}
		}
		exists = var:loan_amount_owed
		exists = var:loan_holder
	}

	is_valid_showing_failures_only = {
		is_available = yes
		gold >= var:loan_amount_owed
	}

	effect = {
		pay_short_term_gold = {
			gold = var:loan_amount_owed
			target = var:loan_holder
		}

		remove_variable = loan_amount_owed
		remove_variable = loan_holder
		remove_character_flag = borrow_from_holy_order
		if = {
			limit = {
				has_character_flag = promised_repayment
			}
			remove_character_flag = promised_repayment
		}
		if = {
			limit = {
				exists = var:has_reminded_about_loan
			}
			remove_variable = has_reminded_about_loan
		}
		if = {
			limit = {
				exists = var:original_loan_holder
			}
			remove_variable = original_loan_holder
		}
		if = {
			limit = {
				any_vassal = {
					exists = var:owes_me_money
				}
			}
			random_vassal = {
				limit = {
					exists = var:owes_me_money
				}
				save_scope_as = recipient
			}
		}
		scope:recipient = {
			remove_variable = owes_me_money
			remove_variable = loan_amount_owed
			if = {
				limit = {
					exists = var:original_lender
				}
				remove_variable = original_lender
			}
		}
	}
	
	ai_potential = {
		always = no
	}

	ai_will_do = {
		base = 0
	}
}
