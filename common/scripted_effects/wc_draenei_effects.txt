### Draenei Spawn
spawn_draenei_effect = {
	title:c_valaar.title_province = {
		save_scope_as = exodar_crashsite
	}

	# Create Velen
	create_character = {
		name = "Velen"
		location = scope:exodar_crashsite
		template = velen_character_template
		save_scope_as = velen
	}
	
	# This needs to be here to make sure courtiers don't spawn somewhere else
	scope:velen = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 15
		}

		give_velen_land_effect = yes
		form_the_exodar_effect = yes
		spawn_colonial_troops_effect = yes
		add_gold = 1000
		add_prestige = 1500
		add_dread = 20
	}
	
	# Create Maraad
	create_character = {
		template = maraad_character_template
		name = "Maraad"
		employer = scope:velen
		save_scope_as = maraad
	}

	scope:maraad = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Artificier Romuul
	create_character = {
		template = romuul_character_template
		name = "Romuul"
		employer = scope:velen
		save_scope_as = romuul
	}

	scope:romuul = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Exarch Menelaous
	create_character = {
		template = menelaous_character_template
		name = "Menelaous"
		employer = scope:velen
		save_scope_as = menelaous
	}

	scope:menelaous = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Exarch Admetius
	create_character = {
		template = admetius_character_template
		name = "Admetius"
		employer = scope:velen
		save_scope_as = admetius
	}

	scope:admetius = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Priestess Iridi
	create_character = {
		template = iridi_character_template
		name = "Iridi"
		employer = scope:velen
		save_scope_as = iridi
	}

	scope:iridi = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Exarch Naielle
	create_character = {
		template = naielle_character_template
		name = "Naielle"
		employer = scope:velen
		save_scope_as = naielle
	}

	scope:naielle = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Sulaa
	create_character = {
		template = sulaa_character_template
		name = "Sulaa"
		employer = scope:velen
		save_scope_as = sulaa
	}

	scope:sulaa = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Vindicator Boros
	create_character = {
		template = boros_character_template
		name = "Boros"
		employer = scope:velen
		save_scope_as = boros
	}

	scope:boros = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
		
		form_the_hand_of_argus_effect = yes
	}
	
	# Create Vindicator Kuros
	create_character = {
		template = kuros_character_template
		name = "Kuros"
		employer = scope:boros
		save_scope_as = kuros
	}

	scope:kuros = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Vindicator Saruan
	create_character = {
		template = saruan_character_template
		name = "Saruan"
		employer = scope:boros
		save_scope_as = saruan
	}

	scope:saruan = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Create Vindicator Aesom
	create_character = {
		template = aesom_character_template
		name = "Aesom"
		employer = scope:boros
		save_scope_as = aesom
	}

	scope:aesom = {
		# Make temporarily immune to disease
		add_character_flag = {
			flag = immune_to_disease
			years = 10
		}
	}
	
	# Spawn some generic knights
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}
	create_character = {
		gender_female_chance = root_soldier_female_chance
		employer = scope:velen
		template = new_warrior_character
		faith = scope:velen.faith
		culture = scope:velen.culture
	}

	# This needs to be last to make sure every recipient in the following effect exists
	scope:velen = { vassalize_feudal_draenei_effect = yes }

	every_player = {
		trigger_event = WCDRN.2		# Crashlanding
	}
}

### Draenei Land
give_velen_land_effect = {
	create_title_and_vassal_change = {
		type = conquest
		save_scope_as = title_change
		add_claim_on_loss = no
	}
	title:c_valaar = {
		change_title_holder = {
			holder = scope:velen
			change = scope:title_change
		}
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
	}
	province:1977 = {
		set_holding_type = church_holding
	}		
	title:c_moongraze = {
		change_title_holder = {
			holder = scope:velen
			change = scope:title_change
		}
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
		set_holding_type = castle_holding
	}
	province:1979 = {
		set_holding_type = castle_holding
	}
	title:c_ammen_vale = {
		change_title_holder = {
			holder = scope:velen
			change = scope:title_change
		}
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
	}
	province:1981 = {
		set_holding_type = church_holding
	}
	title:c_wrathscale = {
		change_title_holder = {
			holder = scope:velen
			change = scope:title_change
		}
		set_county_culture = culture:draenei
		set_county_faith = faith:naaru
	}
	province:1973 = {
		set_holding_type = castle_holding
	}
	resolve_title_and_vassal_change = scope:title_change
}

### Draenei Titles
form_the_exodar_effect = {
	#Create the title
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = no
	}
	title:k_exodar = {
		change_title_holder = {
			holder = scope:velen
			change = scope:title_change
		}
	}
	title:d_naaru = {
		change_title_holder = {
			holder = scope:velen
			change = scope:title_change
		}
	}
	
	resolve_title_and_vassal_change = scope:title_change
	
	add_realm_law_skip_effects = bishop_theocratic_succession_law

	assert_if = {
		limit = { NOT = { exists = title:k_exodar } }
		text = "Exodar title was not created!"
	}
	assert_if = {
		limit = { NOT = { exists = title:d_naaru } }
		text = "Naaru Church title was not created!"
	}

	hidden_effect = { set_primary_title_to = title:k_exodar }

	every_held_title = {
		limit = {
			tier = tier_kingdom
			NOT = { this = title:k_exodar }
		}
		scope:velen = {
			destroy_title = prev
		}
	}
	every_held_title = {
		limit = {
			tier = tier_duchy
			NOT = { this = title:d_naaru }
		}
		scope:velen = {
			destroy_title = prev
		}
	}
}

form_the_hand_of_argus_effect = {
	#Create the title
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = no
	}
    create_title_and_vassal_change = {
        type = swear_fealty
        save_scope_as = vassal_change
    }
	title:d_hand_of_argus = {
		change_title_holder = {
			holder = scope:boros
			change = scope:title_change
		}
        change_liege = {
			liege = scope:velen
			change = scope:vassal_change
		}
	}
	resolve_title_and_vassal_change = scope:title_change
	resolve_title_and_vassal_change = scope:vassal_change

	scope:boros = {
		change_government = holy_order_government
	}
	
	add_realm_law_skip_effects = holy_order_succession_law

	assert_if = {
		limit = { NOT = { exists = title:d_hand_of_argus } }
		text = "Hand of Argus title was not created!"
	}

	hidden_effect = { set_primary_title_to = title:d_hand_of_argus }

	every_held_title = {
		limit = {
			tier = tier_duchy
			NOT = { this = title:d_hand_of_argus }
		}
		scope:boros = {
			destroy_title = prev
		}
	}
}

vassalize_feudal_draenei_effect = {
	create_title_and_vassal_change = {
		type = conquest
		save_scope_as = title_change
		add_claim_on_loss = no
	}
    create_title_and_vassal_change = {
        type = swear_fealty
        save_scope_as = vassal_change
    }
	
	title:c_moongraze = {
		change_title_holder = {
			holder = scope:menelaous
			change = scope:title_change
		}
        change_liege = {
			liege = scope:velen
			change = scope:vassal_change
		}

		add_realm_law_skip_effects = single_heir_succession_law
	}	
	
	title:c_wrathscale = {
		change_title_holder = {
			holder = scope:admetius
			change = scope:title_change
		}
        change_liege = {
			liege = scope:velen
			change = scope:vassal_change
		}

		add_realm_law_skip_effects = single_heir_succession_law		
	}
	resolve_title_and_vassal_change = scope:title_change
	resolve_title_and_vassal_change = scope:vassal_change
	
	scope:admetius = { change_government = feudal_government }
	scope:menelaous = { change_government = feudal_government }
}	